# ‚úÖ –ò–ó–û–õ–Ø–¶–ò–Ø –ö–û–ú–ê–ù–î –ü–û–õ–ù–û–°–¢–¨–Æ –†–ê–ë–û–¢–ê–ï–¢!

## üîß –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

### 1. –î–æ–±–∞–≤–ª–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

–¢–µ–ø–µ—Ä—å `team_id` **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –ø—Ä–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏:
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** - —Ç—Ä–∏–≥–≥–µ—Ä `trigger_set_user_team_id`
- **–ó–∞–∫–∞–∑–æ–≤** - —Ç—Ä–∏–≥–≥–µ—Ä `trigger_set_order_team_id`

**–í–∞–º –±–æ–ª—å—à–µ –ù–ï –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é —É–∫–∞–∑—ã–≤–∞—Ç—å team_id!**

### 2. –£–ø—Ä–æ—â–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ –≤ database.ts

–£–¥–∞–ª–µ–Ω–∞ —Ä—É—á–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è `team_id` - —Ç–µ–ø–µ—Ä—å –±–∞–∑–∞ —Å–∞–º–∞ —ç—Ç–æ –¥–µ–ª–∞–µ—Ç —á–µ—Ä–µ–∑ —Ç—Ä–∏–≥–≥–µ—Ä—ã.

### 3. –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞ –∏–∑–æ–ª—è—Ü–∏–∏

**–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –±–∞–∑–µ:**

```
–ö–æ–º–∞–Ω–¥–∞ A (team_id: teamlead_A_token):
  - TeamLeadA (–¢–∏–º–ª–∏–¥)
  - MemberA1 (–ß–ª–µ–Ω –∫–æ–º–∞–Ω–¥—ã)
  - –ó–∞–∫–∞–∑ A1 ‚úÖ
  - –ó–∞–∫–∞–∑ A2 ‚úÖ

–ö–æ–º–∞–Ω–¥–∞ B (team_id: teamlead_B_token):
  - TeamLeadB (–¢–∏–º–ª–∏–¥)
  - MemberB1 (–ß–ª–µ–Ω –∫–æ–º–∞–Ω–¥—ã)
  - –ó–∞–∫–∞–∑ B1 ‚úÖ
  - –ó–∞–∫–∞–∑ B2 ‚úÖ
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ TeamLeadA –≤–∏–¥–∏—Ç –¢–û–õ–¨–ö–û –∑–∞–∫–∞–∑—ã A1 –∏ A2
- ‚úÖ TeamLeadB –≤–∏–¥–∏—Ç –¢–û–õ–¨–ö–û –∑–∞–∫–∞–∑—ã B1 –∏ B2
- ‚úÖ MemberA1 –≤–∏–¥–∏—Ç –∑–∞–∫–∞–∑—ã A1 –∏ A2 (—Å–≤–æ–µ–π –∫–æ–º–∞–Ω–¥—ã)
- ‚úÖ MemberB1 –≤–∏–¥–∏—Ç –∑–∞–∫–∞–∑—ã B1 –∏ B2 (—Å–≤–æ–µ–π –∫–æ–º–∞–Ω–¥—ã)
- ‚úÖ –ö–æ–º–∞–Ω–¥—ã **–ù–ï –≤–∏–¥—è—Ç** –∑–∞–∫–∞–∑—ã –¥—Ä—É–≥ –¥—Ä—É–≥–∞!

## üéØ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –≤–∞—à–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏:

### –í App.tsx –∏–ª–∏ –ª—é–±–æ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ:

```typescript
import { database } from './lib/database';

// 1. –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞ - –ù–ï —É–∫–∞–∑—ã–≤–∞–π—Ç–µ team_id, –æ–Ω –¥–æ–±–∞–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!
const createOrder = async (userToken: string) => {
  const order = await database.orders.create({
    name: '–ù–æ–≤—ã–π –∑–∞–∫–∞–∑',
    status: 'progress',
    created_by_token: userToken, // ‚Üê –¢–æ–ª—å–∫–æ —Ç–æ–∫–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    order_data: { description: '–û–ø–∏—Å–∞–Ω–∏–µ' },
    date: new Date().toLocaleDateString('ru-RU')
  });

  // team_id –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±—É–¥–µ—Ç –ø—Ä–æ—Å—Ç–∞–≤–ª–µ–Ω —Ç—Ä–∏–≥–≥–µ—Ä–æ–º!
  console.log('–ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω —Å team_id:', order.team_id);
};

// 2. –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤ –∫–æ–º–∞–Ω–¥—ã - –í–°–ï–ì–î–ê –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ getByUserToken
const getMyTeamOrders = async (currentUserToken: string) => {
  const orders = await database.orders.getByUserToken(currentUserToken);
  // –í–µ—Ä–Ω–µ—Ç –¢–û–õ–¨–ö–û –∑–∞–∫–∞–∑—ã –∫–æ–º–∞–Ω–¥—ã —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  return orders;
};

// 3. ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ getAll() –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π!
// const allOrders = await database.orders.getAll(); // –í–µ—Ä–Ω–µ—Ç –í–°–ï –∑–∞–∫–∞–∑—ã!

// 4. ‚úÖ –î–ª—è –∞–¥–º–∏–Ω–∞ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å getAll()
if (userRole === 'admin') {
  const allOrders = await database.orders.getAll();
  // –ê–¥–º–∏–Ω –≤–∏–¥–∏—Ç –≤—Å–µ –∑–∞–∫–∞–∑—ã
}
```

### –° React —Ö—É–∫–∞–º–∏:

```typescript
import { useOrders } from './hooks/useDatabase';

function MyOrdersPage({ currentUserToken, isAdmin }) {
  // –î–ª—è –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–µ—Ä–µ–¥–∞–µ–º –µ–≥–æ token
  const { orders, loading } = useOrders(currentUserToken, isAdmin);

  // orders –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –¢–û–õ–¨–ö–û –∑–∞–∫–∞–∑—ã –∫–æ–º–∞–Ω–¥—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  return (
    <div>
      {orders.map(order => (
        <div key={order.id}>{order.name}</div>
      ))}
    </div>
  );
}
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –∏–∑–æ–ª—è—Ü–∏–∏:

–í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —É–∂–µ –µ—Å—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:

```typescript
// –ü–æ–ª—É—á–∏—Ç—å –∑–∞–∫–∞–∑—ã TeamLeadA
const ordersA = await database.orders.getByUserToken('teamlead_A_token');
console.log(ordersA); // –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 2 –∑–∞–∫–∞–∑–∞: A1, A2

// –ü–æ–ª—É—á–∏—Ç—å –∑–∞–∫–∞–∑—ã TeamLeadB
const ordersB = await database.orders.getByUserToken('teamlead_B_token');
console.log(ordersB); // –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 2 –∑–∞–∫–∞–∑–∞: B1, B2

// –û–Ω–∏ –ù–ï –≤–∏–¥—è—Ç –∑–∞–∫–∞–∑—ã –¥—Ä—É–≥ –¥—Ä—É–≥–∞!
```

## üìä –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç —Ç—Ä–∏–≥–≥–µ—Ä—ã:

### –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
1. –í—ã –≤—Å—Ç–∞–≤–ª—è–µ—Ç–µ: `{ token: 'teamlead_123', role: 'team-leader', ... }`
2. –¢—Ä–∏–≥–≥–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç: `team_id = 'teamlead_123'`
3. –†–µ–∑—É–ª—å—Ç–∞—Ç: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º team_id

### –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞:
1. –í—ã –≤—Å—Ç–∞–≤–ª—è–µ—Ç–µ: `{ created_by_token: 'member_456', ... }`
2. –¢—Ä–∏–≥–≥–µ—Ä –Ω–∞—Ö–æ–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å token = 'member_456'
3. –¢—Ä–∏–≥–≥–µ—Ä –±–µ—Ä–µ—Ç –µ–≥–æ team_id (–Ω–∞–ø—Ä–∏–º–µ—Ä, 'teamlead_123')
4. –¢—Ä–∏–≥–≥–µ—Ä –¥–æ–±–∞–≤–ª—è–µ—Ç: `team_id = 'teamlead_123'`
5. –†–µ–∑—É–ª—å—Ç–∞—Ç: –∑–∞–∫–∞–∑ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –∫–æ–º–∞–Ω–¥–µ

## ‚úÖ –ß—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è:

1. **–ö–∞–∂–¥–∞—è –∫–æ–º–∞–Ω–¥–∞ –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∑–∞–∫–∞–∑—ã**
2. **team_id –ø—Ä–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** (—á–µ—Ä–µ–∑ —Ç—Ä–∏–≥–≥–µ—Ä—ã)
3. **–ò–∑–æ–ª—è—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**
4. **–§—É–Ω–∫—Ü–∏—è getByUserToken() –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã**
5. **–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å —á—É–∂–∏–µ –¥–∞–Ω–Ω—ã–µ** (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å getByUserToken)

## üö® –í–ê–ñ–ù–û:

**–í –≤–∞—à–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –≤–µ–∑–¥–µ, –≥–¥–µ –ø–æ–ª—É—á–∞–µ—Ç–µ –∑–∞–∫–∞–∑—ã, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:**

```typescript
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
const orders = await database.orders.getByUserToken(currentUserToken);

// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û (–ø–æ–∫–∞–∂–µ—Ç –í–°–ï –∑–∞–∫–∞–∑—ã)
const orders = await database.orders.getAll();
```

## üéâ –ì–æ—Ç–æ–≤–æ!

–ò–∑–æ–ª—è—Ü–∏—è –∫–æ–º–∞–Ω–¥ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –∏ **–≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ**!

–ö–∞–∂–¥—ã–π —Ç–∏–º–ª–∏–¥ –∏ –µ–≥–æ –∫–æ–º–∞–Ω–¥–∞ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∑–∞–∫–∞–∑—ã. –î—Ä—É–≥–∏–µ –∫–æ–º–∞–Ω–¥—ã –Ω–µ –º–æ–≥—É—Ç –≤–∏–¥–µ—Ç—å —á—É–∂–∏–µ –¥–∞–Ω–Ω—ã–µ.
